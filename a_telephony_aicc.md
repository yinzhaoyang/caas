# 说明
本文简要介绍一种中小型、单数据中心的云端智能电话呼叫管理系统的设计。如需进一步了解，可邮件咨询：jonny.yin@outlook.com

# 需求概述
+ 系统可以通过SIP与SIP Gateway对接，实现与PSTN电话号码（手机号码，固定电话号码）进行呼叫通话。
+ 系统提供AI对话机器人，实现自动对话。
+ 人工坐席可以通过浏览器接听电话，实现人工对话。
+ 系统可进行预测式外呼：即先呼叫电话号码，号码接通后再呼叫人工坐席以节省坐席占用。系统可根据人工坐席数量及号码接通率自动调整并发呼叫数量以优化人工坐席效率。
+ 对话过程中实时判断用户意图，根据意图将AI机器人对话的通话转移到人工坐席。
+ 语音的识别处理，用户意图的判断准确率满足典型场景要求。
+ 支持多租户。
+ 随着客户/用户增加，系统可通过服务扩展正常运行。
+ 系统具有高可用性。

# 架构

基于云原生开发的DevOps流程，除了aicc系统架构，下图同时展示了开发和运维架构。


![aicc_architecture](aicc_architecture.drawio.png)

<a href="https://app.diagrams.net/#Hyinzhaoyang%2Faicc%2Fmaster%2Faicc_architecture.drawio.png" target="_blank">Edit in diagrams.net</a>

## 开发架构(DEV Domain)
git -- 代码管理  
jenkins -- 编译测试部署自动化jobs管理  
jira -- 需求及开发任务管理  
conflunce -- 共享文档管理  
对于个人开发者及小团队，建议直接使用DevOps-SaaS，如 [阿里云云效DevOps平台](https://devops.aliyun.com/)  


## 运维架构(OPS Domain)
运维架构基于Kubernates，具有以下优点：
+ 屏蔽不同运行环境(本地，不同云服务)差异。在本地环境可以先部署Kubernetes底座，其他云环境的Kubernate服务的部署运行基本一致。
+ Kubernates提供了强大的配置管理，服务调度，服务扩展能力。

## 业务系统架构
业务系统划分为两个域：运营管理域和业务流程域。
+ 业务场景不同：运营管理域向系统运营人员提供管理后台，进行各种配置(账号管理/坐席管理/线路管理/用户管理)及运营数据分析。业务流程域向终端用户提供通信服务。
+ 数据安全要求不同：运营管理域的服务向少数特定人员开放，通过认证鉴权等方式进行数据访问权限的控制。业务流程域仅需要支撑流程运行必须的数据，应与数据进行访问隔离。
+ 性能要求不同：业务流程域在流程处理速度稳定性上有更高的要求。
+ 扩展性要求不同：业务域需要随着用户增长进行动态扩容，运营管理域的系统能力相对稳定。

### 主要服务介绍
#### 运营管理服务
基于Web-Server前后端架构，为运营人员和坐席人员提供WebUI交互能力和相应的数据存取服务。具有较多的技术框架(Java, Nodejs, Python, ...)可以实现。推荐Java系列，参考实现和技术人员都非常丰富。

#### 任务调度服务
什么是呼叫任务？  
呼叫任务是批量电话处理任务，其包含批量的被叫号码，使用的线路，接待机器人及人工坐席信息，处理策略等。

任务控制器(Task Controller)根据任务信息，将呼叫任务拆分创建为单个的号码呼叫指令，发送到消息队列。
任务代理(Task Agent)分布在具备任务处理能力的节点，从消息队列中获取呼叫指令，发送到呼叫处理系统处理。同时接收呼叫处理系统反馈的呼叫状态并根据呼叫策略进行呼叫的状态管理。

Task Controller/Task Agent是一种典型的 资源调度和分布式执行系统，可以参考K8S中的各种资源调度器的策略架构及实现。

#### 呼叫处理服务

